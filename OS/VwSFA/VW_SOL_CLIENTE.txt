CREATE VIEW VW_SOL_CLIENTE
AS
SELECT
	VDCLICLI_ICMS_DIFERIDO AS 'abateICMS',
	VDCLICLI_ALTEDT AS 'alterou',
	'' AS 'barCode',
	VDCLICLI_MOTBLO AS 'motivoBloqClasse20',
	NULL AS 'bonusDisponivel',
	NULL AS 'utilizaVendaCruzada',
	NULL AS 'canalCandidato',
	NULL AS 'canalRegular',
	VDCLICLI_CARGO AS 'cargo',
	VDCLICLI_CLASSE AS 'classe',
	'' AS 'codigoCanal',
	VDCLICLI_TBPRD AS 'codigoTabelaPrecoCliente',
	'' AS 'condicaoPagamentoCliente',
	VDCLICLI_CONTATO AS 'contato',
	VDCLICLI_GPS_X AS 'gpsLatitude',
	VDCLICLI_GPS_Y AS 'gpsLongitude',
	VDCLICLI_CGC AS 'cpfCnpj',
	VDCLICLI_CURVA AS 'curva',
	VDCLICLI_PERM_PED_FORA_GPS AS 'desconsideraGpsPedido',
	NULL AS 'descontoFinanceiro',
	VDCLICLI_ABONA_TX_FINANC AS 'desprezaTaxaFinanceira',
	VDCLICLI_DIAS_UTEIS AS 'diaSemana',
	VDCLICLI_DIAS_ENTREGA AS 'diasEntrega',
	VDCLICLI_EMAIL AS 'email',
	'' AS 'grupoCanal',
	VDCLICLI_VISITA1_HORA_TARDE AS 'horaFinalVisita',
	VDCLICLI_VISITA1_HORA_CEDO AS 'horaInicialVisita',
	VDCLICLI_ICMRET AS 'icmsRetido',
	VDCLICLI_INEST AS 'inscricaoEstadual',
	VDCLICLI_CREDITO AS 'limiteCredito',
	CAST(VDCLICLI_NUM AS VARCHAR(4)) AS 'numeroCliente',
	VDCLICLI_OPINA AS 'opina',
	VDCLICLI_CODPASTA1 AS 'pasta',
	VDCLICLI_PESQDIARIA AS 'pesquisaDiaria',
	VDCLICLI_PESQDIARIAEFET AS 'pesquisaDiariaRealizada',
	0 AS 'pesquisaPPS',
	0 AS 'pesquisaPPSEfetivada',
	VDCLICLI_VERBA_FIN_PRO AS 'usoVerbaRestritoProduto',
	NULL AS 'qtdComodatoFreezers',
	NULL AS 'qtdCevVasilhames',
	0 AS 'cevDiversos',
	VDCLICLI_RAZAO50 AS 'razaoSocial',
	VDCLICLI_REGIAO AS 'regiaoCliente',
	'' AS 'regiaoInclusao',
	VDCLICLI_RESTR_COMERCIAIS AS 'restricaoComercial',
	VDCLICLI_DIA_VISITA_CONCOR01 AS 'sequenciaVisita',
	VDCLICLI_SIGLA AS 'sigla',
	VDCLICLI_SUBCANAL AS 'subCanal',
	NULL AS 'taxaFinancieraCliente',
	CASE WHEN Char_length(Cast( vdclicli_fone AS CHAR (12))) = 11 THEN Subblobtochar(Cast( vdclicli_fone AS CHAR(12)), 1, 2) WHEN Char_length(Cast( vdclicli_fone AS CHAR (12))) = 12 THEN Subblobtochar(Cast( vdclicli_fone AS CHAR(12)), 1, 3) ELSE '0' END AS'telefoneDdd',
	CASE WHEN vdclicli_fone is null THEN'0' WHEN Char_length(Cast( vdclicli_fone AS CHAR (12))) <= 9 THEN Cast( vdclicli_fone AS CHAR ( 12)) WHEN Char_length(Cast(vdclicli_fone AS CHAR (12))) = 12 THEN substring(Cast(vdclicli_fone AS CHAR( 12)), 4, 12 ) ELSE CASE WHEN Char_length(Cast( vdclicli_fone AS CHAR(12 ))) = 1 THEN '0' ELSE substring(Cast( vdclicli_fone AS CHAR( 12)), 3, 11 ) END END AS 'telefoneTronco',
	VDCLICLI_TIPOCAD AS 'tipoCliente',
	VDCLICLI_TPCOBRA AS 'tipoCobrancaCliente',
	NULL AS 'verificadoCNPJ',
	NULL AS 'verificadoIE',
	0 AS 'verificarIE',
	0 AS 'verificarCNPJ',
	VDCLICLI_IGNORA_BANDA_PRECO AS 'ignoraBandaPreco',
	VDCLICLI_MOTBLO_JUR AS 'motivoBloqueioJuridico',
	'' AS 'motivoBloqueioFinanceiro',
	VDCLICLI_REST AS 'sobra',
	VDCLICLI_DISP_PORTAL_WEB AS 'statusTransmitidoWebService',
	VDCLICLI_BAIFAT AS 'bairro',
	VDCLICLI_CEPFAT AS 'cepEndereco',
	VDCLICLI_ENDFAT AS 'endereco',
	VDCLICLI_MUNFAT AS 'municipio',
	VDCLICLI_ENDFAT_NR AS 'numero',
	VDCLICLI_FONE AS 'numeroCliente',
	'' AS 'origemLogradouro',
	'' AS 'pontoReferencia',
	VDCLICLI_REGIAO AS 'regiaoCliente',
	VDCLICLI_ENDFAT_TIP AS 'tipoLogradouro',
	VDCLICLI_ESTFAT AS 'ufEndereco'
FROM DBCONTROL3596001.CADCLI01;