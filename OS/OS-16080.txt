CREATE OR REPLACE VIEW VW_PAROCO AS
SELECT
    VDPAROCO_CODEMP AS CODIGO_EMPRESA,
    VDPAROCO_OCOKD_BIMOB_CL AS OCORRENCIA_BIMOB_CL,
    VDPAROCO_OCOKD_BIMOB_SL AS OCORRENCIA_BIMOB_SL,
    VDPAROCO_OCVDVAS AS OCORRENCIA_VENDA_VASILHAME,
    VDPAROCO_OCOKD_VIMOB_SL AS OCORRENCIA_VIMOB_SL,
    VDPAROCO_OCCEVSAI AS OCORRENCIA_CEV_SAIDA,
    VDPAROCO_OCCEVSAI_FE AS OCORRENCIA_CEV_SAIDA_FE,
    VDPAROCO_OCCEVREC AS OCORRENCIA_CEV_RECOLHIMENTO,
    VDPAROCO_OCCEVREC_FE AS OCORRENCIA_CEV_RECOLHIMENTO_FE,
    VDPAROCO_OCCEVSAI_SL AS OCORRENCIA_CEV_RECOLHIMENTO_SL,
    VDPAROCO_OCCEVSAI_FE_SL AS OCORRENCIA_CEV_RECOLHIMENTO_FE_SL,
    VDPAROCO_DEV_KAR_DIAANT_FIN AS OCORRENCIA_DEV_DIA_ANTERIOR_FIN,
    VDPAROCO_DEV_KAR_DIAANT_NFIN AS OCORRENCIA_DEV_DIA_ANTERIOR_NAO_FIN,
    VDPAROCO_OCOKD_COMPRA AS OCORRENCIA_COMPRA,
    VDPAROCO_OCOKD_COMPRA_BONIF AS OCORRENCIA_COMPRA_BONIFICADA,
    VDPAROCO_OCO_AUTOCONS AS OCORRENCIA_AUTOCONS,
    VDPAROCO_QUEBRA AS QUEBRA,
    VDPAROCO_QUEBRA2 AS QUEBRA2,
    VDPAROCO_QUEBRA3 AS QUEBRA3,
    VDPAROCO_OCO_VDA_DIRETA AS OCORRENCIA_VENDA_DIRETA,
    VDPAROCO_OCO_DIGPED AS OCORRENCIA_DIGIPED,
    VDPAROCO_OCCONSIG AS OCORRENCIA_CONSIG,
    VDPAROCO_OCOKDREM AS OCORRENCIA_REM,
    VDPAROCO_OCOKDREM_BONIF AS OCORRENCIA_REM_BONIFICADO,
    VDPAROCO_OCOKDREM_ESPECIAL AS OCORRENCIA_REM_ESPECIAL,
    VDPAROCO_OCBON1 AS OCORRENCIA_BONIFICADA_1,
    VDPAROCO_OCBON2 AS OCORRENCIA_BONIFICADA_2,
    VDPAROCO_OCBON3 AS OCORRENCIA_BONIFICADA_3,
    VDPAROCO_OCBON4 AS OCORRENCIA_BONIFICADA_4,
    VDPAROCO_OCB0N5 AS OCORRENCIA_BONIFICADA_5,
    VDPAROCO_OCTCA1 AS OCORRENCIA_TROCA1,
    VDPAROCO_OCTCA2 AS OCORRENCIA_TROCA2,
    VDPAROCO_OCTCA3 AS OCORRENCIA_TROCA3,
    VDPAROCO_OCTCA4 AS OCORRENCIA_TROCA4,
    VDPAROCO_OCTCA5 AS OCORRENCIA_TROCA5,
    VDPAROCO_SPREM_E AS SPREM_E,
    VDPAROCO_SPREM_I AS SPREM_I,
    VDPAROCO_OCOKDRETV AS COCORRENCIA_RETV,
    VDPAROCO_OCOKDSAIV AS COCORRENCIA_SAIV,
    VDPAROCO_OCO_INV_SABOR_E AS COCORRENCIA_INV_SABOR_E,
    VDPAROCO_OCO_INV_SABOR_S AS COCORRENCIA_INV_SABOR_S,
    VDPAROCO_OCO_INV_SABOR_E_ANT AS COCORRENCIA_INV_SABOR_E_ANT,
    VDPAROCO_OCO_INV_SABOR_S_ANT AS COCORRENCIA_INV_SABOR_S_ANT,
    VDPAROCO_TAB_CUSTO_PROD AS CODIGO_TABELA_CUSTO_ERP,
    VDPAROCO_TAB_PREMED_VDA AS COCORRENCIA_TAB_PREMED_VDA,
    CASE WHEN LENGTH(CAST(VDPAROCO_CLIENTE AS VARCHAR(008))) = 5 THEN CONCAT('000', CAST(VDPAROCO_CLIENTE AS VARCHAR(008))) WHEN LENGTH(CAST(VDPAROCO_CLIENTE AS VARCHAR(008))) = 6 THEN CONCAT('00', CAST(VDPAROCO_CLIENTE AS VARCHAR(008))) WHEN LENGTH(CAST(VDPAROCO_CLIENTE AS VARCHAR(008))) = 7 THEN CONCAT('0', CAST(VDPAROCO_CLIENTE AS VARCHAR(008))) ELSE CAST(VDPAROCO_CLIENTE AS VARCHAR(008)) END AS CODIGO_CLIENTE_ERP,
    VDPAROCO_TIPCLI AS TIPCLI,
    VDPAROCO_TIPPRD AS TIPPRD,
    VDPAROCO_TIPPLA AS TIPLA,
    VDPAROCO_VISFAT AS VISFAT,
    VDPAROCO_VERBA AS VERBA,
    VDPAROCO_INDENIZA AS INDENIZA,
    VDPAROCO_INTEGRA_FORMA_CONTBL AS INTREGRA_CONTABEL,
    VDPAROCO_IGUALLC AS IGUALIC,
    VDPAROCO_ANTECIPADO AS ANTECIPADO,
    VDPAROCO_SOLAVANCO AS SOLAVANCO,
    VDPAROCO_TIPFOR AS TIPFOR,
    VDPAROCO_TABCUSTO_FREPUXA AS TABCUSTO_PREPUXA,
    VDPAROCO_TABCUSTO_FREENTR AS TABELA_CUSTO_FRETE_ENTRGA,
    VDPAROCO_OCOKD_COMPRA_FE AS OCORRENCIA_COMPRA_FE,
    VDPAROCO_OCOTK_ENTFUTURA AS OCORRENCIA_ENTFUTURA,
    VDPAROCO_OCOTK_VENFAT AS OCORRENCIA_VENFAT,
    VDPAROCO_ANOTAB_CARGA AS ANO_TABELA_CARGA,
    VDPAROCO_MESTAB_CARGA AS MES_TABELA_CARGA,
    VDPAROCO_USA_BANDPREC AS USA_BANDEIRA,
    VDPAROCO_SENHA_LIB AS SENHA_LIB,
    VDPAROCO_CTRL_RESTRICOES AS RESTRICAO_FINANCEIRA,
    VDPAROCO_RESTR_COMERCIAL AS RESTRICAO_COMERCIAL,
    VDPAROCO_FAM_FAMC_BAND AS BANDA_FAM_FAMC,
    VDPAROCO_REG_PASTA_BANDPREC AS BANDA_REG_PASTA,
    VDPAROCO_BDA_VEN_SUP_GER AS BANDA_VEN_SUP_GER,
    VDPAROCO_CAN_GRPCAN_BANDPREC AS BANDA_CAN_GRPCAN,
    VDPAROC2_BLOQ_OCOR_DIST PERMITE_OCOR_DISTINTA,
    VDPAROC2_CTRL_PRAZOCLI_PALM CTRL_PRAZO_CLI_PALM,
    VDPAROC2_S_CANC_PED_PORTAL SENHA_CANCELAMENTO
FROM
  PAROCO01
LEFT JOIN
  PAROC201 ON VDPAROC2_CODEMP = VDPAROCO_CODEMP
WHERE
    (
        VDPAROCO_CODEMP = @CODIGO_EMPRESA
        OR @CODIGO_EMPRESA = 0
    );
    
DECLARE SET VARCHAR(12) @CODIGO_PEDIDO = '';
--
--
--
CREATE OR REPLACE VIEW VW_MENSAGENS AS
SELECT 
  VDCLIGMP_COD CODIGO_MENSAGEM,
  CASE WHEN VDCLIGMP_TIPO = 1 THEN 
         'SEMPRE' 
       ELSE 
         'PERIODO' 
  END PARAMETRO_EXIBICAO,
  CASE WHEN VDCLIGMP_TIPO = 1 THEN 
         '' 
       ELSE 
         CAST(VDCLIGMP_DTTPO1 AS VARCHAR(8))
  END PERIODO_INICIAL,
  CASE WHEN VDCLIGMP_TIPO = 1 THEN 
         '' 
       ELSE 
         CAST(VDCLIGMP_DTTPO2 AS VARCHAR(8))
  END PERIODO_FINAL,
  CASE WHEN VDCLIGMP_SELECAO = 1 THEN 
         'VENDEDOR'
       WHEN VDCLIGMP_SELECAO = 2 THEN
         'CLIENTE'
       WHEN VDCLIGMP_SELECAO = 3 THEN
         'CANAL'
       WHEN VDCLIGMP_SELECAO = 4 THEN
         'GRUPO_ANALISE'
       WHEN VDCLIGMP_SELECAO = 5 THEN 
         'ANIVERSARIANTES_AUTOMATICA'
       WHEN VDCLIGMP_SELECAO = 6 THEN 
         'COMODATOS_VENCIDOS_AUTOMATICA'
       WHEN VDCLIGMP_SELECAO = 7 THEN
         'FAMILIA_PRODUTO'
       WHEN VDCLIGMP_SELECAO = 8 THEN
         'TABELA_PRECO'
       WHEN VDCLIGMP_SELECAO = 9 THEN
         'OCORRENCIA'
       WHEN VDCLIGMP_SELECAO = 10 THEN
         'MOTIVO_BONIFICACAO'
       WHEN VDCLIGMP_SELECAO = 11 THEN
         'MOTIVO_TROCA'
       WHEN VDCLIGMP_SELECAO = 12 THEN
         'MOTIVO_COMODATO'
  END TIPO_SELECAO,
  CASE WHEN VDCLIGMP_SELECAO = 1 THEN 
         VDCLIGMP_VEN1
       WHEN VDCLIGMP_SELECAO = 2 THEN
         CAST(VDCLIGMP_COD1 AS VARCHAR(8))
       WHEN VDCLIGMP_SELECAO = 3 THEN
         VDCLIGMP_CANAL1
       WHEN VDCLIGMP_SELECAO = 4 THEN
         CAST(VDCLIGMP_GRPANALISE1 AS VARCHAR(4))
       WHEN VDCLIGMP_SELECAO = 5 THEN 
         ''
       WHEN VDCLIGMP_SELECAO = 6 THEN 
         ''
       WHEN VDCLIGMP_SELECAO = 7 THEN
         CAST(VDCLIGMP_CODPRD1 AS VARCHAR(6))
       WHEN VDCLIGMP_SELECAO = 8 THEN
         CAST(VDCLIGMP_TBPRD1 AS VARCHAR(8))
       WHEN VDCLIGMP_SELECAO = 9 THEN
         CAST(VDCLIGMP_OCORRENCIA1 AS VARCHAR(4))
       WHEN VDCLIGMP_SELECAO = 10 THEN
         CAST(VDCLIGMP_MOTBONIF1 AS VARCHAR(4))
       WHEN VDCLIGMP_SELECAO = 11 THEN
         VDCLIGMP_MOTTROCA1
       WHEN VDCLIGMP_SELECAO = 12 THEN
         VDCLIGMP_MOTCEV1
  END DADO_SELECAO_INICIAL,
  CASE WHEN VDCLIGMP_SELECAO = 1 THEN 
         VDCLIGMP_VEN2
       WHEN VDCLIGMP_SELECAO = 2 THEN
         CAST(VDCLIGMP_COD2 AS VARCHAR(8))
       WHEN VDCLIGMP_SELECAO = 3 THEN
         VDCLIGMP_CANAL2
       WHEN VDCLIGMP_SELECAO = 4 THEN
         CAST(VDCLIGMP_GRPANALISE2 AS VARCHAR(4))
       WHEN VDCLIGMP_SELECAO = 5 THEN ''
       WHEN VDCLIGMP_SELECAO = 6 THEN ''
       WHEN VDCLIGMP_SELECAO = 7 THEN
         CAST(VDCLIGMP_CODPRD2 AS VARCHAR(6))
       WHEN VDCLIGMP_SELECAO = 8 THEN
         CAST(VDCLIGMP_TBPRD2 AS VARCHAR(8))
       WHEN VDCLIGMP_SELECAO = 9 THEN
         CAST(VDCLIGMP_OCORRENCIA2 AS VARCHAR(4))
       WHEN VDCLIGMP_SELECAO = 10 THEN
         CAST(VDCLIGMP_MOTBONIF2 AS VARCHAR(4))
       WHEN VDCLIGMP_SELECAO = 11 THEN
         VDCLIGMP_MOTTROCA2
       WHEN VDCLIGMP_SELECAO = 12 THEN
         VDCLIGMP_MOTCEV2
  END DADO_SELECAO_FINAL,
  VDCLIGMP_DESCR MENSAGEM
FROM
  VDCLGM01
WHERE 
  VDCLIGMP_COD = @CODIGO_MENSAGEM OR @CODIGO_MENSAGEM = 0;
--
--
--
CREATE OR REPLACE VIEW VW_CONDICAO_PAGAMENTO AS SELECT
condpg01. "vdcadpag_ativo" AS ATIVO,
condpg01. "vdcadpag_cod" AS CODIGO_CONDICAO_PAGAMENTO_ERP,
condpg01. "vdcadpag_descr" AS DESCRICAO,
CASE WHEN condpg01. "vdcadpag_cod" = 1 THEN 1
ELSE 0 END AS INFORMA_PRIMEIRA_PARCELA,
condpg01. "vdcadpag_nrdias" AS NUMERO_DIAS,
condpg01. "vdcadpag_prazo" AS PRAZO,
VDCADPAG_SFA_DISP as DISPONIVEL,
VDCADPAG_DISP_PORTAL_WEB as DISP_PORTAL
FROM CONDPG01 
WHERE (condpg01."vdcadpag_cod" = @CODIGO_CONDICAO_PAGAMENTO OR @CODIGO_CONDICAO_PAGAMENTO = 0);
--
--
--
declare set varchar(255) @CODIGO_CLIENTE = '';

CREATE or replace VIEW VW_VENDEDOR_CLIENTE AS
SELECT
  1 ATIVO,
  CODIGO_CLIENTE CODIGO_CLIENTE_ERP,
  1 VENDEDOR,
  VDCLICLI_VEN CODIGO_VENDEDOR_ERP,
  VDCLICLI_CODPASTA1 PASTA_VISITA
FROM
  VW_DADOS_CLIENTE
WHERE
  CODIGO_CLIENTE = @CODIGO_CLIENTE OR @CODIGO_CLIENTE = '';