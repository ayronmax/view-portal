CREATE OR REPLACE VIEW VW_MENSAGENS AS
SELECT 
  VDCLIGMP_COD CODIGO_MENSAGEM,
  CASE WHEN VDCLIGMP_TIPO = 1 THEN 
         'SEMPRE' 
       ELSE 
         'PERIODO' 
  END PARAMETRO_EXIBICAO,
  CASE WHEN VDCLIGMP_TIPO = 1 THEN 
         '' 
       ELSE 
         CAST(VDCLIGMP_DTTPO1 AS VARCHAR(8))
  END PERIODO_INICIAL,
  CASE WHEN VDCLIGMP_TIPO = 1 THEN 
         '' 
       ELSE 
         CAST(VDCLIGMP_DTTPO2 AS VARCHAR(8))
  END PERIODO_FINAL,
  CASE WHEN VDCLIGMP_SELECAO = 1 THEN 
         'VENDEDOR'
       WHEN VDCLIGMP_SELECAO = 2 THEN
         'CLIENTE'
       WHEN VDCLIGMP_SELECAO = 3 THEN
         'CANAL'
       WHEN VDCLIGMP_SELECAO = 4 THEN
         'GRUPO_ANALISE'
       WHEN VDCLIGMP_SELECAO = 5 THEN 
         'ANIVERSARIANTES_AUTOMATICA'
       WHEN VDCLIGMP_SELECAO = 6 THEN 
         'COMODATOS_VENCIDOS_AUTOMATICA'
       WHEN VDCLIGMP_SELECAO = 7 THEN
         'FAMILIA_PRODUTO'
       WHEN VDCLIGMP_SELECAO = 8 THEN
         'TABELA_PRECO'
       WHEN VDCLIGMP_SELECAO = 9 THEN
         'OCORRENCIA'
       WHEN VDCLIGMP_SELECAO = 10 THEN
         'MOTIVO_BONIFICACAO'
       WHEN VDCLIGMP_SELECAO = 11 THEN
         'MOTIVO_TROCA'
       WHEN VDCLIGMP_SELECAO = 12 THEN
         'MOTIVO_COMODATO'
  END TIPO_SELECAO,
  CASE WHEN VDCLIGMP_SELECAO = 1 THEN 
         VDCLIGMP_VEN1
       WHEN VDCLIGMP_SELECAO = 2 THEN
         CAST(VDCLIGMP_COD1 AS VARCHAR(8))
       WHEN VDCLIGMP_SELECAO = 3 THEN
         VDCLIGMP_CANAL1
       WHEN VDCLIGMP_SELECAO = 4 THEN
         CAST(VDCLIGMP_GRPANALISE1 AS VARCHAR(4))
       WHEN VDCLIGMP_SELECAO = 5 THEN 
         ''
       WHEN VDCLIGMP_SELECAO = 6 THEN 
         ''
       WHEN VDCLIGMP_SELECAO = 7 THEN
         CAST(VDCLIGMP_CODPRD1 AS VARCHAR(6))
       WHEN VDCLIGMP_SELECAO = 8 THEN
         CAST(VDCLIGMP_TBPRD1 AS VARCHAR(8))
       WHEN VDCLIGMP_SELECAO = 9 THEN
         CAST(VDCLIGMP_OCORRENCIA1 AS VARCHAR(4))
       WHEN VDCLIGMP_SELECAO = 10 THEN
         CAST(VDCLIGMP_MOTBONIF1 AS VARCHAR(4))
       WHEN VDCLIGMP_SELECAO = 11 THEN
         VDCLIGMP_MOTTROCA1
       WHEN VDCLIGMP_SELECAO = 12 THEN
         VDCLIGMP_MOTCEV1
  END DADO_SELECAO_INICIAL,
  CASE WHEN VDCLIGMP_SELECAO = 1 THEN 
         VDCLIGMP_VEN2
       WHEN VDCLIGMP_SELECAO = 2 THEN
         CAST(VDCLIGMP_COD2 AS VARCHAR(8))
       WHEN VDCLIGMP_SELECAO = 3 THEN
         VDCLIGMP_CANAL2
       WHEN VDCLIGMP_SELECAO = 4 THEN
         CAST(VDCLIGMP_GRPANALISE2 AS VARCHAR(4))
       WHEN VDCLIGMP_SELECAO = 5 THEN ''
       WHEN VDCLIGMP_SELECAO = 6 THEN ''
       WHEN VDCLIGMP_SELECAO = 7 THEN
         CAST(VDCLIGMP_CODPRD2 AS VARCHAR(6))
       WHEN VDCLIGMP_SELECAO = 8 THEN
         CAST(VDCLIGMP_TBPRD2 AS VARCHAR(8))
       WHEN VDCLIGMP_SELECAO = 9 THEN
         CAST(VDCLIGMP_OCORRENCIA2 AS VARCHAR(4))
       WHEN VDCLIGMP_SELECAO = 10 THEN
         CAST(VDCLIGMP_MOTBONIF2 AS VARCHAR(4))
       WHEN VDCLIGMP_SELECAO = 11 THEN
         VDCLIGMP_MOTTROCA2
       WHEN VDCLIGMP_SELECAO = 12 THEN
         VDCLIGMP_MOTCEV2
  END DADO_SELECAO_FINAL,
  VDCLIGMP_DESCR MENSAGEM
FROM
  VDCLGM01
WHERE 
  VDCLIGMP_COD = @CODIGO_MENSAGEM OR @CODIGO_MENSAGEM = 0;